# Maintainer: Kasei Wang <cnsdwpc at gmail.com>
_pkgname=v2ray
pkgname=$_pkgname-bin
pkgver=1.21.1
pkgrel=1
pkgdesc="A platform for building proxy applications to bypass certain network restrictions."
arch=("i686" "x86_64")
url="https://github.com/v2ray/v2ray-core"
license=("MIT")
depends=()
provides=()
replaces=()
conflicts=()

if [ "$CARCH" = "i686" ]; then
  _arch="32"
fi
if [ "$CARCH" = "x86_64" ]; then
  _arch="64"
fi
source=("https://github.com/v2ray/v2ray-core/releases/download/v$pkgver/v2ray-linux-$_arch.zip"
        "v2ray@.service")
sha256sums=('b79bf320ca254679f7746d0576788cb9f97c1f7273090076f2255c074218dff5'
            '2bbb242616de52218b1a53dab217abbfa85bb8aac4b39b69f82ff02f7d7b8fe0')

package() {
  install -Dm644 "$srcdir/v2ray@.service" "$pkgdir/usr/lib/systemd/system/v2ray@.service"
  cd "$srcdir/$_pkgname-v$pkgver-linux-$_arch"
  install -Dm755 v2ray "$pkgdir/usr/bin/v2ray"
  install -Dm644 vpoint_socks_vmess.json "$pkgdir/etc/v2ray/vpoint_socks_vmess.json"
  install -Dm644 vpoint_vmess_freedom.json "$pkgdir/etc/v2ray/vpoint_vmess_freedom.json"
}
